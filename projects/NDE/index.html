<!DOCTYPE html>
<html>

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Jeehyun Hwang


  | Neural Diffusion Equations 

</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/projects/1_project/">


<!-- Dark Mode -->
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>



  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://jeehyunHwang.github.io/">
       Jeehyun Hwang
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              main
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
            <a class="nav-link" href="/about/">
              about
              
            </a>
          </li>
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          
          
          <!-- <li class="nav-item dropdown ">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                submenus
                
              </a>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
              
              
                <a class="dropdown-item" href="/publications/">publications</a>
              
              
              
                <div class="dropdown-divider"></div>
              
              
              
                <a class="dropdown-item" href="/projects/">projects</a>
              
              
              </div>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/teaching/">
                teaching
                
              </a>
          </li> -->
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">
  
  <header class="post-header">
    <h1 class="post-title">Neural Diffusion Equations</h1>
    <p class="post-description">NDE: Climate Modeling with Neural Diffusion Equation, ICDM'21 [<a href="/assets/pdf/Climate_Modeling_with_Neural_Ordinary_Differential_Equations.pdf" target="_blank" rel="noopener noreferrer"><U>PDF</U></a>][<a href="https://github.com/jeehyunHwang/Neural-Diffusion-Equation" target="_blank" rel="noopener noreferrer"><U>CODE</U></a>]</p>
    <img class="img-fluid rounded z-depth-1" src="/assets/resized/NDE_thumbnail.png">
  </header>

  <article>
    <p></p>

<p>
  <h2>How it all started</h2>
  Climate modeling with neural diffusion equations, started off as a task for capstone project in Yonsei University.
  After working on the <a href="/projects/NPDE/">neural partial differential equations (Neural PDE)</a> project in 
  <a href="https://sites.google.com/view/npark/home">BigDyl</a> lab with Prof.Noseong Park, which was closely related to 
  <a href="https://towardsdatascience.com/neural-odes-breakdown-of-another-deep-learning-breakthrough-3e78c7213795">neural ODE</a> 
  and <a href="https://maziarraissi.github.io/PINNs/">PINN</a>,   
  my interest was mainly focused in neural differential equations and physics informed neural networks. During the time of research for the project Neural PDE, 
  I learned about climate modeling through the partial differential equation. However, attempts on directly applying Neural PDE to climate datasets, or
  to other spatiotemporal datasets, weren't successful as expected. This induced me to dig deeper into the recent successes of spatiotemporal models, which
  produced successful prediction results in climate forecasting / traffic forecasting tasks during the time.
</p>
<div class="row justify-content-sm-center">
  <div class="col-sm-10 mt-2 mt-md-0">
  <img class="img-fluid rounded center" src="/assets/resized/NDE_FRAMEWORK.png">
  </div>
</div>
<div class="caption">
  The overall workflow of the proposed <i>neural diffusion equation</i>. 
</div>
<h2>So what is Neural Diffusion Equation?</h2>
<p>
  Before diving in to extensions and interpretations of the proposed NDE, I would like to explain briefly about the concept (For those who want more detailed 
  explanation on the method, please refer to the paper, [<a href="/assets/pdf/Climate_Modeling_with_Neural_Ordinary_Differential_Equations.pdf">PDF</a>].). 
</p>
</p>
<div class="row justify-content-sm-center">
  <div class="col-sm-10 mt-2 mt-md-0">
  <img class="img-fluid" src="/assets/resized/NDE_model.png">
  </div>
</div>
<div class="caption">
Description of the proposed model, <i>NDE</i>.  
</div>
<p>
  The weather stations (and their sensing values) are represented as a graph and our NDE predicts their future values. Given a graph \(G = (V, E) \) annotated 
  with node and edge features, the core NDE layer evolves \(H_V^{(0)}\) to \(H_V^{(1)}\), followed by a decoding layer which produces predictions. The NDE
  layer consists of two parts: i) the diffusion equation and ii) the neural network based uncertainty model \(f\).</p><p>
  In our model, diffusion equation consists of the predefined graph laplacian matrix, and learnable heat capacity matrix. There are four types for heat capacity modeling as follows.<br>
  1)<b>Edge class</b>: We learn a heat capacity coefficient for each class of edges when edge features are one-hot vectors. Edge classes are predefined by the land 
  usage of each node(land).<br>
  2)<b>Heat matrix</b>: We learn a heat capacity matrix \(K ‚àà R^{|V|√ó|V|}\).<br>
  3)<b>Single coefficient</b>: We learn a single heat capacity coefficient \(k ‚àà R\).<br>
  4)<b>Fixed coeefficient</b>: We consider the case of \(k=1\).<br>
  Uncertainty model, \(f\) consists of a neural networks with small number of parameter, for modeling noise in the given climate dataset to deal with the part that
  cannot be addressed by diffusion processes alone.
</p>
<p>
  <h2>Perspectives of interpreting NDE</h2>
  <p>
    There are two ways to view the proposed concept NDE.
  </p><p>
    (1) Modeling diffusion equation with Neural ODE<br>
    (2) Continuous version of graph neural networks.
  </p>

  Differentiable Physics-informed Graph Networks (DPGN) [1], is a good starting point on explaining why NDE can be viewed as 
  modeling diffusion equation with Neural ODE. As stated in [1], number of physics equations are involved in climate observations,
  and it is almost infeasible to include all required equations. Therefore, they suggested a solution involving graph neural networks,
  using diffusion equation as a regularizer in the loss function. The heat diffusion equation on graph \(G\) can be expressed as follows when
   applied to a graph structure. $$v_i' = v_i + k(Œîv)_i \tag1$$ 
  Where \(v_i\) denotes the \(i\)th node of the graph \(G\), \(k\) indicates the heat capacity, and \(Œî\) represents the graph Laplacian operator.
  Since graph is a 1 dimensional representation, diffusion equation can be displayed in a form of ordinary differential equation.
  $$\frac{dh(t)}{dt} = -kŒîh(t) \tag2$$
  Here, \(h \in R^{|V|\times1}\)is a vector that contains a value for each node. This enables the application of neural ODE. 
  Though this may seem as a simple extension of neural ODE, the concept contains much deeper interpretations and extensions. 
</p>
<div class="row justify-content-sm-center">
  <div class="col-sm-3 mt-2 mt-md-0">
    <img class="img-fluid" src="/assets/resized/t1.jpg">
  </div>
  <div class="col-sm-3 mt-2 mt-md-0">
    <img class="img-fluid" src="/assets/resized/t2.jpg">
  </div>
  <div class="col-sm-3 mt-2 mt-md-0">
    <img class="img-fluid" src="/assets/resized/t3.jpg">
  </div>
  <div class="col-sm-3 mt-2 mt-md-0">
    <img class="img-fluid" src="/assets/resized/t4.jpg">
  </div>
</div>
<div class="caption">
  Temperature change of LA dataset over time. Nodes are exchanging temperature similar to heat diffusion process.
</div>
<p>
  Graph Neural Networks (GNNs), operate by exchanging information between adjacent nodes in the form of message passing. This process is 
  conceptually equivalent to diffusion process, where nodes conduct diffusion through the edges between each other. This analogy can be 
  applied in various GNN based papers. Take for example, simple graph convolution (SGC) [2]. SGC has the following layer definition. 
  $$H(m) = S^mH(0) \tag3$$ 
  where \(H\) is the node hidden matrix, and \(S^m\) is the \(m\)-th power of the symmetrically normalized adjacency matrix S with added self loops.
  Then, <i>Eq.(2)</i> can be derived from <i>Eq.(3)</i>, as proven in our paper, where <i>Eq.(2)</i> becomes equivalent to <i>Eq.(3)</i> when Euler method with a unit 
  step size is used. This analogy of diffusion based GNNs to continuous graph neural networks enables simple euler solvers to be expanded to various solvers, such 
  as Dormand-Prince method or implicit solvers. Moreover, neural network for uncertainty modeling can be applied side by side with diffusion equation completing 
  the equation for our NDE.
</p>
<h2>Where NDE leads us</h2>
<p>
  Our method, therefore, can be viewed as where the study of physics informed neural networks and graph neural networks, and neural differential equations meet.
  This also suggests us that there are multiple ways to expand or change and reinvent the concept. Currently, me and my colleagues are working on not only its 
  applications but also developing its theory.</p><p>
  Since there are numerous equations that can be applied in this framework, a simple extension would be changing the differential equation.
  Advection-diffusion (or convection-diffusion) equation, would the most straight-forward extension of our work, which also takes into consideration of the direction
  of graph. Since the graph structure and edge classes are maintained throughout the whole process of our proposed training process, dynamic graphs or graph-structure
  learning can also be an advancement. Finally, controlled differential equations, a more general equation that ordinary differential equation that uses Riemman 
  integral, can also be a good direction to advance. (Check on our new project <a href="/projects/STG-NCDE/index.html">STG-NCDE</a>)</p>
  <p>Currently, this project is under journal extension process.‚ú®</p>
<p>
  <h3>References</h3>
  [1]S. Seo and Y. Liu, ‚ÄúDifferentiable physics-informed graph networks,‚Äù arXiv preprint, 2019<br>
  [2]F. Wu, A. Souza, T. Zhang, C. Fifty, T. Yu, and K. Weinberger, ‚ÄúSimplifying graph convolutional networks,‚Äù in ICML. PMLR, 2019.<br>
</p>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    ¬© Copyright 2021 Jeehyun Hwang.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

    
    
    Last updated: November 05, 2021.
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  





</html>
